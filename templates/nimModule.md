$$ # StaticTea template for generating markdown documents from nim
$$ # modules with doc comments.
$$ #
$$ # Create a list of all the heading names.
$$ #
$$ block
$$ : t.repeat = len(s.entries)
$$ : entry = s.entries[t.row]
$$ : g.names &= entry.name
$$ endblock
$$ #
$$ # Define replacement patterns to remove formatting from the descriptions.
$$ #
$$ block
$$ : g.patterns = list( +
$$ :   "@@", "", +
$$ :   "@{", "[", +
$$ :   "}@", "]", +
$$ :   "@!", "|", +
$$ :   "[ ]*@:", "\n", +
$$ :   "@\\.", "*", +
$$ :   "&quot;", "\"", +
$$ :   "&gt;", ">", +
$$ :   "&lt;", "<", +
$$ :   "&amp;", "&")
$$ : path = path(s.orig)
$$ : g.moduleName = path.filename
$$ : t.repeat = if0(len(s.entries), 0, 1)
$$ : g.anchors = githubAnchor(g.names)
$$ endblock
$$ #
$$ # Reformat the entries list and store it in g.entries.
$$ #
$$ block
$$ : t.repeat = len(s.entries)
$$ : entry = get(s.entries, t.row, dict())
$$ : newEntry = dict()
$$ : newEntry.name = entry.name
$$ : cases = list("skType", "type: ", +
$$ :   "skConst", "const: ", +
$$ :   "skMacro", "macro: ")
$$ : newEntry.type = case(entry.type, cases, "")
$$ : desc = get(entry, "description", "")
$$ : sentence = slice(desc, 0, add(find(desc, ".", -1), 1))
$$ : newEntry.short = replaceRe(sentence, g.patterns)
$$ : newEntry.description = replaceRe(desc, g.patterns)
$$ : code = replaceRe(entry.code, list("[ ]*$", ""))
$$ : pos = find(code, " {", len(code))
$$ : newEntry.signature = slice(code, 0, pos)
$$ : newEntry.anchor = g.anchors[t.row]
$$ : g.entries &= newEntry
$$ endblock
$$ #
$$ # Module section.
$$ #
$$ block
$$ : modDescription = replaceRe(s.moduleDescription, g.patterns)
# {g.moduleName}

{modDescription}

* [{g.moduleName}](../src/{g.moduleName}) &mdash; Nim source code.
$$ endblock
$$ #
$$ # Show the index label when there are entries.
$$ #
$$ nextline
$$ : t.repeat = if0(len(s.entries), 0, 1)
# Index

$$ #
$$ # Create the index.
$$ #
$$ nextline
$$ : if(not(exists(g, "entries")), return("stop"))
$$ : t.repeat = len(g.entries)
$$ : entry = g.entries[t.row]
* {entry.type}[{entry.name}](#{entry.anchor}) &mdash; {entry.short}

$$ #
$$ # Create the function sections.
$$ #
$$ block
$$ : if(not(exists(g, "entries")), return("stop"))
$$ : t.repeat = len(g.entries)
$$ : entry = g.entries[t.row]
# {entry.name}

{entry.description}

```nim
{entry.signature}
```

$$ endblock

---
â¦¿ Markdown page generated by [StaticTea](https://github.com/flenniken/statictea/) from nim doc comments. â¦¿
