# jsondocraw.nim

Generate json data from a nim source file. It's like nim's jsondoc
command except no html presentation information is in the
descriptions. The descriptions match the source.


* [jsondocraw.nim](../../src/jsondocraw.nim) &mdash; Nim source code.
# Index

* const: [helpText](#helptext) &mdash; alternate doc comment used instead of the first line.
* type: [Args](#args) &mdash; Args holds the arguments specified on the command line.
* [newArgs](#newargs) &mdash; Create an Args object from a CmlArgs.
* [getMessage](#getmessage) &mdash; Return a message from a message id and problem argument.
* [`$`](#) &mdash; Return a string representation of an Args object.
* [readOneDesc](#readonedesc) &mdash; Return the doc comment found in the given range of line numbers.
* [readDescriptions](#readdescriptions) &mdash; Read all the descriptions in the text specified by the line numbers.
* [removePresentation](#removepresentation) &mdash; Create a json file without presentation formatting in the descriptions.

# helpText

alternate doc comment used instead
of the first line.


~~~nim
helpText = """
Create a json file like nim's jsondoc command except the descriptions
do not contain any html presentation information.  This command runs
nim jsondoc command then post processes the data to patch the
descriptions.

Usage:
  jsondocraw [-h] [-v] srcFilename destFilename

  -h --help — show this message
  -v --version — show the version number

  srcFilename — nim source filename
  destFilename — filename of the json file to create

If nim's jsondoc command crashes, replace the problem characters and
try again. You can also use an alternate document comment #$ as a
workaround. For example:

proc myRoutine(a: int): string =
  ## required simple line
  #$ alternate doc comment used instead
  #$ of the first line.
  result = $a
"""
~~~

# Args

Args holds the arguments specified on the command line.

* help — help or -h was specified
* noOptions — no options or arguments specified
* version — version or -v was specified
* srcFilename — nim source filename
* destJsonFile — name of the JSON file to create


~~~nim
Args = object
  help*: bool
  noOptions*: bool
  version*: bool
  srcFilename*: string
  destJsonFile*: string
~~~

# newArgs

Create an Args object from a CmlArgs.


~~~nim
func newArgs(cmlArgs: CmlArgs): Args {.raises: [KeyError], tags: [].}
~~~

# getMessage

Return a message from a message id and problem argument.


~~~nim
func getMessage(message: CmlMessageId; problemArg: string = ""): string {.
    raises: [ValueError], tags: [].}
~~~

# `$`

Return a string representation of an Args object.


~~~nim
func `$`(args: Args): string {.raises: [ValueError], tags: [].}
~~~

# readOneDesc

Return the doc comment found in the given range of line
numbers. Look for #$ first then, if not found, look for ##.


~~~nim
proc readOneDesc(srcLines: seq[string]; start: int; finish: int): string {.
    raises: [RegexError], tags: [].}
~~~

# readDescriptions

Read all the descriptions in the text specified by the line
numbers. Return a dictionary mapping the line number to its
description.


~~~nim
proc readDescriptions(text: string; lineNums: seq[int]): OrderedTable[string,
    string] {.raises: [RegexError], tags: [].}
~~~

# removePresentation

Create a json file without presentation formatting in the
descriptions.  Pass in a source filename and the name of the json
file to create.


~~~nim
proc removePresentation(args: Args) {.raises: [JsonDocRawError, ValueError,
    OSError, Exception, IOError, JsonParsingError, KeyError, RegexError], tags: [
    ReadDirEffect, ReadEnvEffect, ReadIOEffect, WriteDirEffect, ExecIOEffect,
    RootEffect, WriteIOEffect].}
~~~


---
⦿ Markdown page generated by [StaticTea](https://github.com/flenniken/statictea/) from nim doc comments. ⦿
