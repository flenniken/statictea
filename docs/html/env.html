<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>env.nim</title>
<style>
body {
    max-width: 40em;
    font-size: 2em;
    margin-left: 1em;
}

#staticteadep {
    width: 100%;
}

.signature {
    color: green;
}

.description {
    white-space: pre-wrap;
}

.nim-code {
    border-left: 6px solid green;
    padding: 16px;
    background-color: #f6f8fa;
    overflow: auto;
}
</style>
</head>
<body>
<h1>env.nim</h1>

<pre class="description">
Environment holding the input and output streams.
</pre>

Nim source code: <a href="../../src/env.nim">env.nim</a>

<h1>Index</h1>

<ul>
<li>const:  <a href="#logWarnSize">logWarnSize</a> &mdash; Warn the user when the log file gets over 1 GB.</li>
<li>const:  <a href="#dtFormat">dtFormat</a> &mdash; The date time format in local time written to the log.</li>
<li>const:  <a href="#maxWarningsWritten">maxWarningsWritten</a> &mdash; The maximum number of warning messages to show.</li>
<li>const:  <a href="#staticteaLog">staticteaLog</a> &mdash; Name of the default statictea log file.</li>
<li>type:  <a href="#Env">Env</a> &mdash; Env holds the input and output streams.</li>
<li> <a href="#close">close</a> &mdash; Close the environment streams.</li>
<li> <a href="#outputWarning">outputWarning</a> &mdash; Write a message to the error stream and increment the warning count.</li>
<li> <a href="#warn">warn</a> &mdash; Write a formatted warning message to the error stream.</li>
<li> <a href="#warn-1">warn</a> &mdash; Write a formatted warning message to the error stream.</li>
<li> <a href="#warnNoFile">warnNoFile</a> &mdash; Write a formatted warning message to the error stream.</li>
<li> <a href="#warnNoFile-1">warnNoFile</a> &mdash; Write a formatted warning message to the error stream.</li>
<li> <a href="#formatLogDateTime">formatLogDateTime</a> &mdash; Return a formatted time stamp for the log.</li>
<li> <a href="#formatLogLine">formatLogLine</a> &mdash; Return a formatted log line.</li>
<li> <a href="#logLine">logLine</a> &mdash; Append a message to the log file.</li>
<li> <a href="#log">log</a> &mdash; Append the message to the log file.</li>
<li> <a href="#writeOut">writeOut</a> &mdash; Write a message to the output stream.</li>
<li> <a href="#writeErr">writeErr</a> &mdash; Write a message to the error stream.</li>
<li> <a href="#checkLogSize">checkLogSize</a> &mdash; Check the log file size and write a warning message when the file is big.</li>
<li> <a href="#openLogFile">openLogFile</a> &mdash; Open the log file and update the environment.</li>
<li> <a href="#openEnv">openEnv</a> &mdash; Open and return the environment containing standard error and standard out as streams.</li>
<li> <a href="#setupLogging">setupLogging</a> &mdash; Turn on logging for the environment using the specified log file.</li>
<li> <a href="#addExtraStreams">addExtraStreams</a> &mdash; Add the template and result streams to the environment.</li>
<li> <a href="#addExtraStreamsForUpdate">addExtraStreamsForUpdate</a> &mdash; For the update case, add the template and result streams to the environment.</li>
</ul>

<h3 id="logWarnSize">logWarnSize</h3>

<pre class="description">
Warn the user when the log file gets over 1 GB.
</pre>

<pre class="nim-code">
logWarnSize: int64 = 1073741824
</pre>

<h3 id="dtFormat">dtFormat</h3>

<pre class="description">
The date time format in local time written to the log.
</pre>

<pre class="nim-code">
dtFormat = "yyyy-MM-dd HH:mm:ss\'.\'fff"
</pre>

<h3 id="maxWarningsWritten">maxWarningsWritten</h3>

<pre class="description">
The maximum number of warning messages to show.
</pre>

<pre class="nim-code">
maxWarningsWritten = 32
</pre>

<h3 id="staticteaLog">staticteaLog</h3>

<pre class="description">
Name of the default statictea log file.  The path on the Mac is different than the other platforms.
</pre>

<pre class="nim-code">
staticteaLog = "/Users/steve/Library/Logs/statictea.log"
</pre>

<h3 id="Env">Env</h3>

<pre class="description">
Env holds the input and output streams.

* errStream -- standard error stream; normally stderr but
might be a normal file for testing.
* outStream -- standard output stream; normally stdout but
might be a normal file for testing.
* logFile -- the open log file
* logFilename -- the log filename
* closeErrStream -- whether to close err stream. You don't
close stderr.
* closeOutStream -- whether to close out stream. You don't
close stdout.
* closeTemplateStream -- whether to close the template stream
* closeResultStream -- whether to close the result stream
* templateFilename -- name of the template file
* templateStream -- template stream, may be stdin
* resultFilename -- name of the result file
* resultStream -- result stream, may be stdout
* warningsWritten -- the total number of warnings
</pre>

<pre class="nim-code">
Env = object
  errStream*: Stream
  outStream*: Stream
  logFile*: File
  logFilename*: string
  closeErrStream*: bool
  closeOutStream*: bool
  closeTemplateStream*: bool
  closeResultStream*: bool
  templateFilename*: string
  templateStream*: Stream
  resultFilename*: string
  resultStream*: Stream
  warningsWritten*: Natural

</pre>

<h3 id="close">close</h3>

<pre class="description">
Close the environment streams.
</pre>

<pre class="nim-code">
proc close(env: var Env)
</pre>

<h3 id="outputWarning">outputWarning</h3>

<pre class="description">
Write a message to the error stream and increment the warning count.
</pre>

<pre class="nim-code">
proc outputWarning(env: var Env; lineNum: Natural; message: string)
</pre>

<h3 id="warn">warn</h3>

<pre class="description">
Write a formatted warning message to the error stream.
</pre>

<pre class="nim-code">
proc warn(env: var Env; filename: string; lineNum: Natural; warning: MessageId;
          p1: string = "")
</pre>

<h3 id="warn-1">warn</h3>

<pre class="description">
Write a formatted warning message to the error stream.
</pre>

<pre class="nim-code">
proc warn(env: var Env; filename: string; lineNum: Natural;
          warningData: WarningData)
</pre>

<h3 id="warnNoFile">warnNoFile</h3>

<pre class="description">
Write a formatted warning message to the error stream.
</pre>

<pre class="nim-code">
proc warnNoFile(env: var Env; messageId: MessageId; p1: string = "")
</pre>

<h3 id="warnNoFile-1">warnNoFile</h3>

<pre class="description">
Write a formatted warning message to the error stream.
</pre>

<pre class="nim-code">
proc warnNoFile(env: var Env; warningData: WarningData)
</pre>

<h3 id="formatLogDateTime">formatLogDateTime</h3>

<pre class="description">
Return a formatted time stamp for the log.
</pre>

<pre class="nim-code">
func formatLogDateTime(dt: DateTime): string
</pre>

<h3 id="formatLogLine">formatLogLine</h3>

<pre class="description">
Return a formatted log line.
</pre>

<pre class="nim-code">
func formatLogLine(filename: string; lineNum: int; message: string; dt = now()): string
</pre>

<h3 id="logLine">logLine</h3>

<pre class="description">
Append a message to the log file. If there is an error writing, close the log. Do nothing when the log is closed. A newline is not added to the line.
</pre>

<pre class="nim-code">
proc logLine(env: var Env; filename: string; lineNum: int; message: string)
</pre>

<h3 id="log">log</h3>

<pre class="description">
Append the message to the log file. The current file and line becomes part of the message.
</pre>

<pre class="nim-code">
template log(env: var Env; message: string)
</pre>

<h3 id="writeOut">writeOut</h3>

<pre class="description">
Write a message to the output stream.
</pre>

<pre class="nim-code">
proc writeOut(env: var Env; message: string)
</pre>

<h3 id="writeErr">writeErr</h3>

<pre class="description">
Write a message to the error stream.
</pre>

<pre class="nim-code">
proc writeErr(env: var Env; message: string)
</pre>

<h3 id="checkLogSize">checkLogSize</h3>

<pre class="description">
Check the log file size and write a warning message when the file is big.
</pre>

<pre class="nim-code">
proc checkLogSize(env: var Env)
</pre>

<h3 id="openLogFile">openLogFile</h3>

<pre class="description">
Open the log file and update the environment. If the log file cannot be opened, a warning is output and the environment is unchanged.
</pre>

<pre class="nim-code">
proc openLogFile(env: var Env; logFilename: string)
</pre>

<h3 id="openEnv">openEnv</h3>

<pre class="description">
Open and return the environment containing standard error and standard out as streams.
</pre>

<pre class="nim-code">
proc openEnv(logFilename: string = ""; warnSize: int64 = logWarnSize): Env
</pre>

<h3 id="setupLogging">setupLogging</h3>

<pre class="description">
Turn on logging for the environment using the specified log file.
</pre>

<pre class="nim-code">
proc setupLogging(env: var Env; logFilename: string = "";
                  warnSize: int64 = logWarnSize)
</pre>

<h3 id="addExtraStreams">addExtraStreams</h3>

<pre class="description">
Add the template and result streams to the environment.
</pre>

<pre class="nim-code">
proc addExtraStreams(env: var Env; templateFilename: string;
                     resultFilename: string): Option[WarningData]
</pre>

<h3 id="addExtraStreamsForUpdate">addExtraStreamsForUpdate</h3>

<pre class="description">
For the update case, add the template and result streams to the environment. Return true on success.
</pre>

<pre class="nim-code">
proc addExtraStreamsForUpdate(env: var Env; resultFilename: string;
                              templateFilename: string): Option[WarningData]
</pre>


<p>⦿ This page was generated
by <a href="https://github.com/flenniken/statictea/">statictea</a>
from nim doc comments. ⦿</p>

</body>
</html>
